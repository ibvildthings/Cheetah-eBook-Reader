<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EBook Reader v3.0</title>
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="chapters-sidebar.css">
</head>
<body>
    <div id="app">
        <!-- Left Sidebar: Chapters Navigation -->
        <div id="chapters-sidebar">
            <button id="chapters-toggle" class="chapters-toggle">â˜°</button>
            <div class="chapters-content">
                <div class="book-metadata">
                    <div class="book-cover-placeholder">ðŸ“–</div>
                    <h2 id="book-title">No Book Loaded</h2>
                    <p id="book-author">Upload an EPUB to begin</p>
                </div>

                <div class="upload-section">
                    <input type="file" id="epub-upload" accept=".epub" style="display: none;">
                    <button id="upload-btn" class="upload-btn">Upload EPUB</button>
                </div>

                <div class="chapters-list" id="chapters-list">
                    <!-- Chapters will be dynamically inserted here -->
                </div>
            </div>
        </div>

        <!-- Center: Reader Content -->
        <div id="reader-container">
            <div class="margin-drag-zone margin-drag-zone-left" id="drag-left"></div>
            <div class="margin-drag-zone margin-drag-zone-right" id="drag-right"></div>
            <div id="reader"></div>
        </div>

        <!-- Right Sidebar: Settings -->
        <div id="sidebar">
            <button id="sidebar-toggle" class="sidebar-toggle">â˜°</button>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h3>Reading Mode</h3>
                    <div class="btn-group">
                        <button id="btn-flow">â–¶ Start Flow</button>
                    </div>
                    <div class="btn-group">
                        <button id="btn-bionic">Bionic</button>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Flow Controls</h3>
                    <div class="control-group">
                        <label>Speed <span class="control-value" id="speed-value">300 WPM</span></label>
                        <input type="range" id="speed-slider" min="100" max="600" value="300">
                    </div>
                    <div class="control-group">
                        <label>Focus Width <span class="control-value" id="focus-value">2</span></label>
                        <input type="range" id="focus-slider" min="1" max="5" value="2">
                    </div>
                    <div class="control-group">
                        <label>Scroll Level <span class="control-value" id="scroll-value">1</span></label>
                        <input type="range" id="scroll-slider" min="1" max="5" value="1">
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Typography</h3>
                    <div class="control-group">
                        <label>Font Family</label>
                        <select id="font-select">
                            <optgroup label="Serif">
                                <option value="georgia" selected>Georgia</option>
                                <option value="merriweather">Merriweather</option>
                                <option value="lora">Lora</option>
                                <option value="crimson">Crimson Pro</option>
                                <option value="baskerville">Libre Baskerville</option>
                            </optgroup>
                            <optgroup label="Sans Serif">
                                <option value="inter">Inter</option>
                                <option value="opensans">Open Sans</option>
                                <option value="sourcesans">Source Sans 3</option>
                                <option value="nunito">Nunito Sans</option>
                            </optgroup>
                            <optgroup label="Monospace">
                                <option value="jetbrains">JetBrains Mono</option>
                                <option value="fira">Fira Mono</option>
                            </optgroup>
                            <optgroup label="Slab">
                                <option value="robotoslab">Roboto Slab</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Font Size <span class="control-value" id="fontsize-value">18px</span></label>
                        <input type="range" id="fontsize-slider" min="12" max="48" value="18">
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Layout</h3>
                    <div class="control-group">
                        <label>Left Margin <span class="control-value" id="margin-left-value">60px</span></label>
                        <input type="range" id="margin-left-slider" min="10" max="400" value="60">
                    </div>
                    <div class="control-group">
                        <label>Right Margin <span class="control-value" id="margin-right-value">60px</span></label>
                        <input type="range" id="margin-right-slider" min="10" max="400" value="60">
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Theme</h3>
                    <div class="btn-group">
                        <button id="theme-light" class="active">Light</button>
                        <button id="theme-dark">Dark</button>
                    </div>
                    <div class="btn-group">
                        <button id="theme-sepia">Sepia</button>
                        <button id="theme-gray">Gray</button>
                    </div>
                    <div class="btn-group">
                        <button id="theme-auto">Auto</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/epubjs/dist/epub.min.js"></script>
    
    <!-- DOMPurify for safe HTML sanitization -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.3.0/dist/purify.min.js"></script>

    <!-- App Scripts -->
    <script src="ebook-reader-core.js"></script>
    <script src="ebook-reader.js"></script>
    <script src="epub-handler.js"></script>
    <script src="app.js"></script>
</body>
</html>